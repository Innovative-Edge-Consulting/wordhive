/* ===================== THEME VARS ===================== */
/* Default: dark (can be overridden by [data-theme] on <html>) */
:root{
  --brand:#497f64;
  --ws-cols: 5;

  /* Dark */
  --bg:#0d0f10;
  --text:#ffffff;
  --muted:#a5b3a8;
  --border:#2a2d31;
  --btnBg:#12161a;

  --tile:#0f1214;
  --tileFilled:#111419;

  --tileSize: clamp(40px, min(9.2vw, (100vw - 64px)/7), 56px);

  --correct:#2ea043;
  --present:#e3b341;
  --absent:#3a3f45;

  --glass:#0e1115cc;
  --card:#111419;
  --shadow: 0 12px 32px rgba(0,0,0,.45);
  --bubbleShadow: 0 6px 18px rgba(0,0,0,.35);
}

/* Light theme overrides */
:root[data-theme="light"]{
  --bg:#ffffff;
  --text:#0b0d0f;
  --muted:#5c636a;
  --border:#d5d9df;
  --btnBg:#ffffff;

  --tile:#ffffff;
  --tileFilled:#f0f3f6;

  --absent:#cbd3dc;

  --glass:#ffffffcc;
  --card:#ffffff;
  --shadow: 0 10px 26px rgba(0,0,0,.08);
  --bubbleShadow: 0 8px 16px rgba(0,0,0,.10);

}

:root[data-theme="dark"]{ --bg:#0d0f10; }

/* ===================== GLOBAL ===================== */
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
}

/* App-controlled backdrop (overrides host CMS/page bg) */
.ws-page-bg{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;

  /* Base background from theme */
  background-color:var(--bg);

  /* Optional very subtle vignette behind game (safe & non-busy) */
  background-image:
    radial-gradient(circle at top center,
      rgba(73,127,100,0.10),
      transparent 60%
    );
  background-repeat:no-repeat;
}

/* ===================== TOP BAR ===================== */
.ws-topbar{
  position:sticky; top:0; z-index:40; width:100%;
  background:var(--glass);
  backdrop-filter: blur(6px);
  border-bottom:1px solid var(--border);
}
.ws-topbar-inner{
  max-width:920px; margin:0 auto; padding:10px 16px;
  display:flex; align-items:center; justify-content:space-between; gap:12px;
}
.ws-brand{
  display:flex; align-items:center; gap:10px;
  font:800 18px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  letter-spacing:.3px;
}

/* Old dot (unused now, but safe to keep) */
.ws-brand .dot{
  width:10px; height:10px; border-radius:50%;
  background:var(--brand); display:inline-block;
}

/* NEW: WordHive logo blocks (green + yellow squares) */
.ws-brand-block{
  width:26px;
  height:26px;
  border-radius:6px;
  display:grid;
  place-items:center;
  font:800 16px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  text-transform:uppercase;
}
.ws-brand-block-w{
  background:var(--correct);
  color:#000;
}
.ws-brand-block-h{
  background:var(--present);
  color:#000;
}
.ws-brand-text{
  font-weight:800;
  letter-spacing:.3px;
}

.ws-actions{ display:flex; align-items:center; gap:8px; }
.icon-btn{
  display:grid; place-items:center;
  width:38px; height:38px; padding:3px; box-sizing:border-box;
  border-radius:10px; border:1px solid var(--border); background:var(--btnBg);
  cursor:pointer; line-height:0;
}
.icon-btn svg{ width:20px; height:20px; stroke:currentColor; color:var(--text); overflow:visible; stroke-linecap:round; stroke-linejoin:round; }

/* ===================== HUD ===================== */
#game{
  position:relative; z-index:1; width:100%; max-width:720px;
  margin:24px auto 48px; padding:0 16px 48px;
  display:flex; flex-direction:column; align-items:center; gap:16px;
}
.ws-hud{
  width:100%; display:flex; justify-content:space-between; align-items:center; gap:12px; max-width:560px;
}
.ws-hud .ws-tag{
  font:600 14px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  padding:8px 10px; border:1px solid var(--border); border-radius:10px; background:var(--card); color:var(--text);
  display:flex; align-items:center; gap:6px;
}
.ws-hud-right{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }

@keyframes ws-pulse{ 0%{transform:scale(1)} 40%{transform:scale(1.07)} 100%{transform:scale(1)} }
.ws-tag.pulse{ animation: ws-pulse 260ms ease; }

/* ===================== STAGE ===================== */
.ws-stage{
  position:relative;
  display:inline-flex;
  flex-direction:column;
  align-items:center;
  gap:12px;
  margin-top:6px;
  max-width:560px;
  width:auto;
  margin-left:auto;
  margin-right:auto;

  /* Reserve room for the Hint Bee on the right (desktop/tablet) */
  padding-right:56px;
}

/* ===================== GRID ===================== */
.ws-grid{ display:grid; gap:8px; justify-items:center; }
.ws-row{ display:grid; gap:8px; }
.ws-tile{
  width:var(--tileSize); height:var(--tileSize);
  border:1px solid var(--border); border-radius:8px;
  display:grid; place-items:center;
  font-weight:700; text-transform:uppercase;
  background:var(--tile); color:var(--text);
  user-select:none;
  transition:transform .06s ease, background .15s ease, border-color .15s ease;
  transform-style:preserve-3d;
}
.ws-tile.active{ outline:2px solid var(--brand); outline-offset:-2px; }
.ws-tile.filled{ background:var(--tileFilled); border-color:#3a3f45; }
:root[data-theme="light"] .ws-tile.filled{ border-color:var(--border); }
.ws-row.ws-locked .ws-tile{ opacity:.9; }

.ws-tile.state-correct{ background:var(--correct); border-color:var(--correct); color:#000; }
.ws-tile.state-present{ background:var(--present); border-color:var(--present); color:#000; }
.ws-tile.state-absent{  background:var(--absent);  border-color:#000; color:var(--text); }

@keyframes ws-flip-1{ 0%{transform:rotateX(0)} 49%{transform:rotateX(90deg)} 51%{transform:rotateX(90deg)} 100%{transform:rotateX(0)} }
.ws-tile.flip{ animation: ws-flip-1 420ms ease var(--flip-delay,0ms) both; }

@keyframes ws-shake{ 0%,100%{transform:translateX(0)} 25%{transform:translateX(-4px)} 75%{transform:translateX(4px)} }
.ws-row.shake .ws-tile{ animation:ws-shake 120ms linear 0s 2; }

/* ===================== KEYBOARD ===================== */
/* Centered, responsive keyboard */
.ws-kb{
  margin-top:8px;
  display:flex;
  flex-direction:column;
  gap:8px;
  width:100%;
  padding:0 12px;
  -webkit-tap-highlight-color:transparent;
  max-width:min(560px, calc(var(--tileSize) * var(--ws-cols, 5) + 8px * (var(--ws-cols, 5) - 1) + 48px));
  margin-left:auto;
  margin-right:auto;
  align-items:center; /* keeps rows centered under grid */
}

.ws-kb-row{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:6px;
  width:100%;
}

.ws-kb-key{
  display:flex;
  align-items:center;
  justify-content:center;
  font:600 14px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  padding:12px 10px;
  min-width:34px;
  border-radius:8px;
  border:1px solid var(--border);
  background:var(--btnBg);
  color:var(--text);
  cursor:pointer;
  user-select:none;
  touch-action:manipulation;
}
.ws-kb-key:active{ transform:translateY(1px) }
.ws-kb-enter{ padding:12px 14px; }
.ws-kb-back{  padding:12px 14px; }

.ws-kb-key.k-correct{ background:var(--correct); border-color:var(--correct); color:#000; }
.ws-kb-key.k-present{ background:var(--present); border-color:var(--present); color:#000; }
.ws-kb-key.k-absent{  background:var(--absent);  border-color:#000; color:var(--text); }

/* Desktop: give Enter/Back more room so label/icon stay centered */
@media (min-width:431px){
  .ws-kb-enter,
  .ws-kb-back{
    min-width:72px;
    padding:12px 18px;
  }
}

/* Unified, responsive system message bubbles (errors + hints) */
.ws-bubble,
.ws-streak-toast{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%, -50%) scale(0.96);
  background:var(--card);
  color:var(--text);
  border:1px solid var(--border);
  border-radius:12px;
  padding:12px 18px;
  font:700 14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  box-shadow:var(--bubbleShadow);
  z-index:200;
  opacity:0;
  pointer-events:none;

  /* âœ… Wider, but still responsive */
  max-width:min(440px, 92vw);  /* was ~320px before */
  text-align:center;
  white-space:normal;          /* allow normal wrapping */
  word-break:normal;
  transition:opacity .22s ease, transform .22s ease;
}

.ws-bubble.show,
.ws-streak-toast.show{
  opacity:1;
  transform:translate(-50%, -50%) scale(1);
  pointer-events:auto;
}

/* Hint/streak toast extra text styling */
.ws-streak-toast .sub{
  display:block;
  margin-top:4px;
  font:600 13px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  color:var(--muted);
}

.ws-streak-toast .row{
  margin-top:8px;
  display:flex;
  justify-content:center;
  gap:8px;
  flex-wrap:wrap;
}

/* ðŸ“± Mobile fine-tune: slightly smaller text + almost full width */
@media (max-width:480px){
  .ws-bubble,
  .ws-streak-toast{
    font-size:13px;
    padding:10px 14px;
    max-width:94vw;
  }
}

/* Anchored streak tooltip */
.ws-streak-tip{
  position:fixed; background:var(--card); color:var(--text);
  border:1px solid var(--border); border-radius:12px; padding:10px 12px;
  font:600 13px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  box-shadow:var(--bubbleShadow); z-index:56; opacity:0; transform:translateY(-6px);
  transition:opacity .16s ease, transform .16s ease; max-width:260px;
}
.ws-streak-tip.show{ opacity:1; transform:translateY(0); }
.ws-streak-tip .row{ display:flex; gap:8px; margin-top:8px; }
.ws-streak-tip .ws-btn{ padding:8px 10px; }

/* ===================== MODALS / CARDS ===================== */
.ws-modal, .ws-endcard{
  position:fixed; inset:0; background:rgba(0,0,0,.6);
  display:flex; align-items:center; justify-content:center; z-index:50;
}
:root[data-theme="light"] .ws-modal, :root[data-theme="light"] .ws-endcard{ background:rgba(8,10,12,.35); }
.ws-modal .card, .ws-endcard .card{
  width:min(92vw,560px); background:var(--card); border:1px solid var(--border);
  border-radius:16px; padding:20px; box-shadow:var(--shadow);
}
.ws-modal h3, .ws-endcard h3{ margin:0 0 10px 0; font:700 20px/1.2 system-ui; }
.ws-modal p, .ws-modal li, .ws-endcard p{ margin:6px 0; color:var(--muted) }
.ws-modal .row, .ws-endcard .row{ display:flex; gap:8px; margin-top:12px; flex-wrap:wrap }
.ws-btn{
  border:1px solid var(--border); background:var(--btnBg); color:var(--text);
  border-radius:10px; padding:10px 12px; font:600 14px/1 system-ui; cursor:pointer;
}
.ws-btn.primary{ background:var(--brand); color:#fff; border-color:var(--brand) }

.ws-mini-row{ display:grid; grid-auto-flow:column; gap:6px; margin-top:8px; }
.ws-mini-tile{ width:28px; height:28px; border-radius:6px; display:grid; place-items:center;
  font:700 12px/1 system-ui; text-transform:uppercase; border:1px solid transparent;
}
.ws-mini-tile.correct{ background:var(--correct); color:#000; }
.ws-mini-tile.present{ background:var(--present); color:#000; }
.ws-mini-tile.absent{  background:var(--absent); color:var(--text); }

/* Settings form */
.ws-form{ display:grid; gap:10px; }
.ws-field{
  display:flex; align-items:center; justify-content:space-between;
  background:var(--tile); border:1px solid var(--border);
  padding:10px; border-radius:10px;
}
.ws-field label{ font:600 14px/1 system-ui; }
.ws-field input[type="checkbox"]{ width:18px; height:18px; }
.ws-field select{
  font:600 14px/1 system-ui; color:var(--text); background:var(--btnBg);
  border:1px solid var(--border); border-radius:8px; padding:8px 10px;
}

/* Floating points chip */
.ws-fxfloat{
  position:fixed; z-index:60; pointer-events:none; font:800 14px/1 system-ui;
  padding:6px 8px; border-radius:999px; background:var(--card); border:1px solid var(--border);
  color:var(--text); box-shadow:0 8px 20px rgba(0,0,0,.45);
  transition: transform 420ms cubic-bezier(.22,.82,.25,1), opacity 420ms ease, left 420ms ease, top 420ms ease;
  opacity:.98;
}
:root[data-theme="light"] .ws-fxfloat{ box-shadow:0 8px 16px rgba(0,0,0,.12); }
.ws-fxfloat.green{ background:var(--correct); color:#000; border-color:var(--correct); }
.ws-fxfloat.yellow{ background:var(--present); color:#000; border-color:var(--present); }

/* ===================== MOBILE ===================== */
@media (max-width:430px){
  :root{ --tileSize: clamp(36px, 10.5vw, 48px); }

  .ws-hud{
    flex-direction:column;
    align-items:stretch;
    gap:10px;
  }
  .ws-hud #ws-level{ width:100%; }
  .ws-hud .ws-tag{ justify-content:center; text-align:center; width:100%; }
  .ws-hud-right{
    width:100%;
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));
    gap:6px;
  }

  .ws-kb{
    padding:0 8px;
    gap:10px;
  }

  .ws-kb-row{
    gap:6px;
    justify-content:center;
    flex-wrap:nowrap;
  }

  .ws-kb-key{
    justify-self:center;
    min-width:auto;
    min-height:clamp(40px, 9.8vw, 50px);
    padding:clamp(10px, 2.4vw, 14px) clamp(8px, 2.6vw, 12px);
    font-size:clamp(13px, 3.6vw, 16px);
    border-radius:10px;
  }
  .ws-kb-enter, .ws-kb-back{
    grid-column:span 2;
    padding:clamp(10px, 2.4vw, 14px) clamp(10px, 3.2vw, 16px);
  }

  .ws-modal .card, .ws-endcard .card { padding:16px; }

  /* On small screens, donâ€™t reserve extra bee space */
  .ws-stage{
    padding-right:0;
  }
}

.ws-hud-right { gap:8px; }
@media (max-width:430px){ .ws-hud-right { gap:6px; } }

/* ===================== HINT BEE HELPER ===================== */
.ws-helper{
  position:absolute;
  top:50%;
  right:-44px;
  transform:translateY(-50%);
  z-index:80;
  width:44px;
  height:44px;
  pointer-events:auto;
  display:flex;
  align-items:center;
  justify-content:center;
}

.ws-helper-bee{
  pointer-events:auto;
  width:42px;
  height:42px;
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--card);
  box-shadow:var(--bubbleShadow);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  cursor:pointer;
}

/* ðŸŸ¢ Bee glow when a hint has been revealed for this level */
.ws-helper-bee.hint-active{
  box-shadow:
    0 0 0 2px var(--brand),
    0 0 14px rgba(73,127,100,0.7);
}

.ws-helper-bee.ws-helper-disabled{
  opacity:0.4;
}

.ws-helper-bubble{
  position:absolute;
  bottom:100%;
  left:50%;
  transform:translateX(-50%) translateY(-8px);
  background:#fff8d6;
  color:#5a4b20;
  font:600 12px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  padding:8px 12px;
  border-radius:12px;
  border:1px solid #e2d9a3;
  box-shadow:0 4px 12px rgba(0,0,0,0.18);
  white-space:nowrap;
  opacity:0;
  pointer-events:none;
  transition:opacity .22s ease, transform .22s ease;
  z-index:999;
}

#ws-helper:hover #ws-helper-bubble,
.ws-helper-bubble.show{
  opacity:1;
  transform:translateX(-50%) translateY(-12px);
}

.ws-helper-bubble::after{
  content:"";
  position:absolute;
  top:100%;
  left:50%;
  transform:translateX(-50%);
  width:0;
  height:0;
  border-top:6px solid #fff8d6;
  border-left:6px solid transparent;
  border-right:6px solid transparent;
  filter:drop-shadow(0 0 1px #e2d9a3);
}

.ws-helper-bubble.ws-helper-nudge{
  max-width:240px;
}

.ws-helper-bubble.ws-helper-nudge.show{
  opacity:1;
}

@media(max-width:480px){
  .ws-helper-bubble{
    font-size:11px;
    padding:6px 10px;
  }
}

/* On very small screens, keep Bee near the grid but tighter so it doesn't break layout */
@media (max-width:430px){
  .ws-helper{
    right:-40px;
    top:45%;
    transform:translateY(-50%);
  }
}
